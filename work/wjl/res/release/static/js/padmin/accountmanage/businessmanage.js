seajs.use("calendar_css"),seajs.use(["$","select","confirmbox","calendar","util"],function(a,b,c,d,e){var f={dialogS1:null,dialogS2:null},g={setSlt:function(){new b({trigger:"#jRole"}).render(),new b({trigger:"#jTypeSel"}).render()},getCreateHtml:function(){var b,c;a("#j-branch").length&&""!==a("#j-branch").html()?(b="",c=['<select id="jAddDepartment" name="dept">',a("#j-branch").html(),"</select>"].join("")):(b="无",c="");var d=['<div class="dialog-form">','<form action="create.aj" id="j_create">','<div class="ui-form-item dialog-form-item">',"<label>员工姓名: </label>",'<input class="ui-input ui-input-large m-numFnull" type="text" value="" name="realName" />',"</div>",'<div class="ui-form-item dialog-form-item">',"<label>所属部门: </label>",b,c,"</div>",'<div class="ui-form-item dialog-form-item">',"<label>登录账号: </label>",'<input placeholder="请输入姓名全拼" class="ui-input ui-input-large m-numFnull" type="text" value="" name="userName" />',"</div>",'<div class="ui-form-item dialog-form-item">',"<label>登录密码: </label>",'<input class="ui-input ui-input-large m-numFnull" type="text" value="" name="passwd" />',"</div>",'<div class="ui-form-item dialog-form-item">',"<label>角色设置: </label>",'<select id="jAddRole" name="roleId">',a("#j-role").html(),"</select>","</div>","</form>","</div>"].join("");return d},getResetPwdHtml:function(a){var b=['<div class="dialog-form">','<form action="resetpwd.aj" id="j_resetpwd">','<div class="ui-form-item dialog-form-item">',"是否确定重置密码？","</div>",'<input type="hidden" name="id" value="',a,'" />',"</form>","</div>"].join("");return b},getFreeze:function(a){var b=['<div class="dialog-form">','<form action="freeze.aj" id="j_resetpwd">','<div class="ui-form-item dialog-form-item">',"是否确定冻结账户？","</div>",'<input type="hidden" name="id" value="',a,'" />',"</form>","</div>"].join("");return b},getEnable:function(a){var b=['<div class="dialog-form">','<form action="enable.aj" id="j_resetpwd">','<div class="ui-form-item dialog-form-item">',"是否确定解冻账户？","</div>",'<input type="hidden" name="id" value="',a,'" />',"</form>","</div>"].join("");return b},getChanHtml:function(b){var c,d;a("#j-branch").length&&""!==a("#j-branch").html()?(b.selcon1&&a("#j-branch").find("option").each(function(){a(this).text()==b.selcon1&&a(this).attr("selected","selected").siblings().attr("selected","")}),c="",d=['<select id="jAddDepartment" name="dept">',a("#j-branch").html(),"</select>"].join("")):(c="无",d=""),b.selcon2&&a("#j-role").find("option").each(function(){a(this).text()==b.selcon2&&a(this).attr("selected",!0).siblings().attr("selected",!1)});var e=['<div class="dialog-form">','<form action="create.aj" id="j_create">','<div class="ui-form-item dialog-form-item">',"<label>员工姓名: </label>","<span>",b.jobname,"</span>",'<input type="hidden" name="userId" value="',b.userid,'" />',"</div>",'<div class="ui-form-item dialog-form-item">',"<label>所属部门: </label>",c,d,"</div>",'<div class="ui-form-item dialog-form-item">',"<label>登录账号: </label>","<span>",b.username,"</span>","</div>",'<div class="ui-form-item dialog-form-item">',"<label>角色设置: </label>",'<select id="jAddRole" name="roleId">',a("#j-role").html(),"</select>","</div>","</form>","</div>"].join("");return e},setDialogSlt:function(){try{f.dialogS1=new b({trigger:"#jAddDepartment",zIndex:9999}).render()}catch(a){}f.dialogS2=new b({trigger:"#jAddRole",zIndex:9999}).render()},bind:function(){a("#jAddBank").on("click",function(){Util.confirm.open({title:"员工姓名",message:g.getCreateHtml(),confirmTpl:'<span class="ui-dialog-button-orange" id="j_bt_yes">确定</span>',cancelTpl:"",onConfirm:function(){var b=!0;a("body").find(".m-numFnull").each(function(){a(this).val()||(b=!1)}),b?g.sb({form:"#j_create",submitButton:"#j_bt_yes"}):alert("请输入完整信息！")},onCancel:function(){},onClose:function(){try{e.delSelect(f.dialogS1)}catch(a){}e.delSelect(f.dialogS2)}}),g.setDialogSlt()}),a(".j-repwd").on("click",function(){var b=a(this).closest("tr").data("id");Util.confirm.open({title:"重置密码",message:g.getResetPwdHtml(b),width:300,confirmTpl:'<span class="ui-button ui-button-mblue" id="j_bt_yes">确定</span>',cancelTpl:'<span class="ui-button ui-button-mblue" id="j_bt_no">取消</span>',onConfirm:function(){g.sb({form:"#j_resetpwd",submitButton:"#j_bt_yes"})},onCancel:function(){e.confirm.close()},onClose:function(){}})}),a(".j-freeze").on("click",function(){var b=a(this).closest("tr").data("id");Util.confirm.open({title:"冻结账户",message:g.getFreeze(b),width:300,confirmTpl:'<span class="ui-button ui-button-mblue" id="j_bt_yes">确定</span>',cancelTpl:'<span class="ui-button ui-button-mblue" id="j_bt_no">取消</span>',onConfirm:function(){g.sb({form:"#j_resetpwd",submitButton:"#j_bt_yes"})},onCancel:function(){e.confirm.close()},onClose:function(){}})}),a(".j-enable").on("click",function(){var b=a(this).closest("tr").data("id");Util.confirm.open({title:"解冻账户",message:g.getEnable(b),width:300,confirmTpl:'<span class="ui-button ui-button-mblue" id="j_bt_yes">确定</span>',cancelTpl:'<span class="ui-button ui-button-mblue" id="j_bt_no">取消</span>',onConfirm:function(){g.sb({form:"#j_resetpwd",submitButton:"#j_bt_yes"})},onCancel:function(){e.confirm.close()},onClose:function(){}})}),a(".j-remsg").on("click",function(){var b=a(this).closest("tr").find("td").eq(1).text(),c=a(this).closest("tr").find("td").eq(3).text(),d=a(this).closest("tr").data("id"),h=a(this).data("deptname"),i=a(this).closest("tr").find("td").eq(2).text();Util.confirm.open({title:"修改",message:g.getChanHtml({jobname:b,username:c,userid:d,selcon1:h,selcon2:i}),confirmTpl:'<span class="ui-dialog-button-orange" id="j_bt_yes">确定</span>',cancelTpl:"",onConfirm:function(){g.sb({form:"#j_create",submitButton:"#j_bt_yes"})},onCancel:function(){},onClose:function(){try{e.delSelect(f.dialogS1)}catch(a){}e.delSelect(f.dialogS2)}}),g.setDialogSlt()})},sb:function(a){e.formSend(a.form,{ajaxSuccess:function(a){e.go(a)},error:function(){e.alert("操作超时")},submitButton:a.submitButton})}},h=function(){g.setSlt(),g.bind()};h(),$$m.finish("ok")});