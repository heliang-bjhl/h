define("custom/util/util",["$","_","tip"],function(a,b,c){var d=a("$"),e=a("_"),f=a("tip"),g=a("confirmbox");Util={setDialog:function(a,b,c){"title"==b&&a.element.find(".ui-dialog-title").html(c),"content"==b&&a.element.find(".ui-dialog-message").html(c)},delSelect:function(a){d(a.element).remove(),a=null},confirm:{open:function(a){Util.confirm._clear(),Util.confirm.d=new g({title:a.title,message:a.message,confirmTpl:a.confirmTpl,cancelTpl:a.cancelTpl,onConfirm:function(){a.onConfirm()},onCancel:function(){a.onCancel()},onClose:function(){a.onClose&&a.onClose()},width:a.width}),Util.confirm.d.show()},d:null,_clear:function(){Util.confirm.d=null},close:function(){Util.confirm.d=null,d(".arale-dialog-1_2_5").remove()}},init:function(){this.pager()},formSend:function(a,b){var c=d(a);if(c.length){var f=c.attr("action");b=b||{},b.extraData=b.extraData||null,b.data=c.serialize(),e.isObject(b.extraData)&&(b.data=[].concat(b.data).concat(d.param(b.extraData)).join("&")),b.form=a,this.send(f,b)}},send:function(a,b){var c=b.data||null,g=null,h=null;b=b||{},b.type=b.type||"post",b.bReload=b.bReload||!1,b.submitButton=b.submitButton||d(b.form).find(":submit");var i=d(b.submitButton);if(a=b.url||a,e.isObject(b.data)&&(c=d.param(b.data)),b.ajaxErrorMsg=b.ajaxErrorMsg||"出错了,请重新提交！",b.error=b.error||null,b.loadingTxt=b.loadingTxt||"提交中...",b.successTxt=b.successTxt||"提交成功!",b.position=b.position||"top",b.delay=b.delay||1e3,submitButton=d(b.submitButton),a&&"1"!=i.data("bajax")){var j=function(){submitButton.hasClass("ui-button-morange")&&submitButton.removeClass("ui-button-morange").addClass("ui-button-mwhite"),submitButton.hasClass("ui-button-lorange")&&submitButton.addClass("ui-button-lwhite "),i.length&&i.data("bajax",1)},k=function(){submitButton.hasClass("ui-button-mwhite")&&submitButton.removeClass("ui-button-mwhite").addClass("ui-button-morange"),submitButton.hasClass("ui-button-lwhite")&&submitButton.removeClass("ui-button-lwhite "),i.length&&i.data("bajax",0)};b.submitButton&&(g=submitButton.data("tips")||new f({trigger:submitButton,triggerType:"click",effect:"fade",content:b.loadingTxt,theme:"white"}),g.show(),h=g.element.find(".ui-poptip-content").attr("class","ui-poptip-content poptip-loading"),submitButton.data("tips",g)),d.ajax({type:b.type,cache:!1,url:a,dataType:"json",data:b.data,beforeSend:function(){j(),g&&(h.html(b.loadingTxt),g.element.show().css("opacity",100))},success:function(a){if(b.success)return b.success(a),void g.element.hide();if(a=a||{},200===a.code)b.ajaxSuccess&&b.ajaxSuccess(a),b.bReload&&setTimeout(function(){location.reload()},200),g&&(h.attr("class","ui-poptip-content poptip-success").html(b.successTxt),g.element.show(),setTimeout(function(){g.element.fadeOut()},3e3));else{if(b.ajaxFail)return void b.ajaxFail(a,g);g&&(h.attr("class","ui-poptip-content poptip-error").html(a.msg||"出错了"),g.element.show(),k()),1===a.code&&b.ajaxSuccess&&b.ajaxSuccess(a)}},error:function(){return b.error?void b.error():(g&&(h.attr("class","ui-poptip-content poptip-error").html(c.msg||"出错了,请尝试重新提交"),g.element.show()),void setTimeout(function(){k(),g.element.fadeOut()},3e3))},complete:function(){i.length&&i.data("bajax",0),g&&g.element.hide(),k()}})}},fixedDom:function(a){if(d(a).length){var a=d(a);return void d(window).on("scroll",function(){var b=d(window).scrollTop();b>50&&a.css({position:"fixed",top:0}),50>b&&a.css({position:"static"})});var a}},textLimit:function(a,b,c){c=c||{},seajs.use("textLimit",function(d){d({input:a||"#inputTitle",tip:b||"#titleLimit",msg:c.msg||function(a){var b=a||{};return b.max-b.count<0?"输入已经超过了可允许的{max}字数":"还能输入{rest}个字"},max:c.max||20,min:c.min>0?c.min:0,enableBr:!0,changeFn:function(){}}).init()})},bindUpload:function(a,b){var c={timestamp:"",token:"",signature:"111",policy:"11"},f=['<li class="no-flash">','<p>您还没有安装flash插件，请点击<a target="_blank" href="http://www.adobe.com/go/getflash">这里</a>安装您将被带到Adobe官网下载</p>',"</li>"].join(""),g=this;if(b=b||{},!swfobject.hasFlashPlayerVersion("9"))return d(a).closest("ul").html(f),!1;var h={hideFlash:function(){var b=d(a);b.css({position:"absolute",left:"-10000px"})},showFlash:function(){var b=d(a);b.css({position:"static"})}};d(a).uploadify(e.extend({height:152,width:153,buttonImage:$$c.staticUrl+"/static/images/upload.png",fileSizeLimit:b.imgSize||"100kb",swf:$$c.domain+"/uploadify.swf",uploader:$$c.uploadUrl,multi:!1,fileObjName:"file",progressData:"speed",fileTypeDesc:"Image Files",fileTypeExts:"*.gif; *.jpg; *.png",method:"post",auto:!1,onSelect:function(){var b=d(a);d.ajax({type:"GET",url:$$c.domain+"/upai/key.aj",dataType:"json"}).done(function(a){c.policy=a.data.policy,c.signature=a.data.signature,d(b).uploadify("upload","*")})},onDialogClose:function(a){!a.filesSelected},onUploadStart:function(){h.hideFlash(d(this));var b=d(a);b.uploadify("settings","formData",c)},onUploadError:function(){},onError:function(){},onUploadComplete:function(){},onUploadSuccess:function(c,e){var f="",i=(d(this)[0].wrapper,null),j=null,k=d.parseJSON(e),l=$$c.resHost+"/"+k.url;f+="<li><div class='control'><span class='close'></span></div><span class='blue-border'></span><img class='loaded-img' data-src='"+k.url+"' src="+l+" /></li>",i=this.wrapper.closest(".btn-upload"),i.before(f),b&&b.max&&b.max<=d(a).closest("ul").find("li").length||h.showFlash(d(this)),j=i.prev().find(".loaded-img"),g.imgCenterScale(j,153,152)}},b)),b&&b.max&&b.max<=d(a).closest("ul").find("li").length&&1==b.init?h.hideFlash(d(a)):h.showFlash(d(a)),d(a).closest("ul").on("click",".close",function(){d(this).closest("li").remove(),h.showFlash()})},imgCenterScale:function(a,b,c,e){function f(a,f){var g=parseInt(f.width,10),h=parseInt(f.height,10),i=null,j=g,k=h;isNaN(parseInt(g))||(i=Math.min(b/g,c/h),j=g*i,k=h*i,(c>h||c>k)&&(a.prev().hasClass(".vh")||(d("<span class='vh'></span>").insertBefore(a),a.css("vertical-align","middle"))),c>h&&b>g||(a.css({width:j,height:k}),e.callback&&e.callback()))}a=d(a),e=e||{},a.each(function(){var a=d(this),b=new Image;b.onload=function(){f(a,this)},b.src=d(this).attr("src")})},pager:function(){function a(a){isNaN(parseInt(a))&&(a=1),e.test(c)?(f=c.replace(/pageNo=\d+/g,function(){return"pageNo="+a}),location.href=f):location.href=/\?/.test(c)?c+"&pageNo="+a:c+"?&pageNo="+a}var b=d(".ui-paging-which"),c=location.href,e=/pageNo=\d+/g,f="";d(".ui-paging-which").length&&(b.on("keydown","input",function(b){13==b.keyCode&&a(d(this).val())}),d(".ui-paging").on("click",".ui-paging-goto",function(){return a(d(".ui-paging-which input").val()),!1}))},alert:function(a){var b=null;seajs.use(["confirmbox"],function(c){var d=['<div class="dialog-form">',a,"</div>"].join("");b=new c({title:"消息对话框",message:d,confirmTpl:'<span class="ui-dialog-button-orange">确定</span>',cancelTpl:"",onConfirm:function(){this.hide()}}),b.show()})},changeRadio:function(a){function b(a,b){var c=b.input,e=b.index,f=b.disable,g=b.enable,h="function"==typeof c?c():c;e=""==d.trim(e)||isNaN(e)?1:e;try{a==e?(d(h).removeAttr("readonly"),d(h).removeAttr("disabled"),g()):(f(),d(h).attr("disabled","disabled"),d(h).attr("readonly","true").val(""))}catch(i){}}return null==a?!1:void seajs.use(["$"],function(c){c(function(){var d=a;c.each(d,function(a,d){!function(){var a=d;a.disable="function"==typeof a.disable?a.disable:function(){},a.enable="function"==typeof a.enable?a.enable:function(){},c('input[name="'+a.name+'"]').click(function(){b(c('input[name="'+a.name+'"]:checked').index('input[name="'+a.name+'"]'),a)}),b(c('input[name="'+a.name+'"]:checked').index('input[name="'+a.name+'"]'),a)}()})})})},timeToString:function(a){var b=a.date||"",c=a.hour,e=a.minute,f=a.type,g="";return g="date"==f?d.trim(d(b).val())+" "+d(c).val()+":"+d(e).val():d(c).val()+":"+d(e).val()},countDown:function(a){var b,c=a.time||2e3,d=a.timeCallBack||function(){},e=a.finalyCallBack||function(){};c/=1e3,b=setInterval(function(){c>=1?(c-=1,d(c)):(clearInterval(b),e())},1e3)},go:function(a,b){b&&b();var a=a||{};location.href=a.data&&a.data.url?a.data.url:location.href},joinCheckboxVal:function(a){var b=[];return d(a).find("input:checked").each(function(){b.push(d(this).val())}),b.join(",")},limitnum:function(a){var b=a.parentClass,c=a.mold||"float";d(b).on("keyup","input",function(){if("num"==d(this).data("rule")||"num"==d(this).data("num")){var a=d(this).val();if("int"==c){var b=parseInt(a)+"";d(this).val(isNaN(b)?"":b)}else{if("float"!=c)return!1;var e=parseFloat(a)+"";isNaN(a)&&d(this).val("NaN"==e?"":e)}}})},getCurrentDate:function(){var a=new Date;return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()},getDateRangeTime:function(a,b){var c=new Date,d=parseInt(a.split("-")[0]),e=parseInt(a.split("-")[1]),f=parseInt(a.split("-")[2]);c.setFullYear(d,e-1,f),c.setDate(f+b);var g=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();return g},getDateRange:function(a,b){var c=new Date(a),d=new Date(b),e=Math.abs(c.getTime()-d.getTime()),f=Math.floor(e/864e5);return f}},Util.ChangeRadio=function(a){this.radioName=a.radioName;var b=d('input[name="'+this.radioName+'"]:checked');this.radios=d('input[name="'+this.radioName+'"]'),this.cur_id=b.attr("id"),this.selects=a.selects,this.init()},d.extend(Util.ChangeRadio.prototype,{init:function(){this.loaded(),this.bind()},loaded:function(){var a=this;d.each(a.radios,function(b,c){d(c).attr("id")!=a.cur_id&&a.disable(c)})},disable:function(a){var b=(d(a).attr("id"),d(a).attr("id")+"_k");d("#"+b).find("input").attr("disabled","disabled"),d("#"+b).find("input").attr("readonly","readonly"),this.selects&&this.selects[b]&&this.disableSlt(this.selects[b])},disableSlt:function(a){for(var b=0;b<a.length;b++)a[b].set("disabled",!0)},enableSlt:function(a){for(var b=0;b<a.length;b++)a[b].set("disabled",!1)},enable:function(a){var b=(d(a).attr("id"),d(a).attr("id")+"_k");d("#"+b).find("input").removeAttr("disabled"),d("#"+b).find("input").removeAttr("readonly"),this.selects&&this.selects[b]&&this.enableSlt(this.selects[b])},bind:function(){var a=this;a.radios.on("change",function(){a.disable(d("#"+a.cur_id),a),a.enable(d(this)),a.cur_id=d(this).attr("id")})}}),d(function(){Util.init()}),c.exports=Util});