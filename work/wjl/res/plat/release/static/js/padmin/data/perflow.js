seajs.use("calendar_css"),seajs.use(["$","util","calendar"],function(a,b,c){var d={},e={setCal:function(){var a=b.getCurrentDate(),d=b.getDateRangeTime(a,-7),e=new c({trigger:"#j_searchTime1",range:[null,a]}),f=new c({trigger:"#j_searchTime2",range:[d,a]});e.on("selectDate",function(c){if(b.getDateRange(c,a)<=7)var d=c._i,e=a;else var d=c._i,e=b.getDateRangeTime(c._i,7);f.range([d,e])}),f.on("selectDate",function(a){var c=b.getDateRangeTime(a._i,-7),d=a._i;e.range([c,d])})},setChart:function(b){a("#contain").highcharts({title:{text:"连续7天分楼层日各时段客流量对比"},subtitle:{text:""},xAxis:{categories:[10,11,12,13,14,15,16,17,18,19,20,21]},yAxis:{title:{text:"人次"},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"人次"},legend:{layout:"vertical",align:"right",verticalAlign:"middle",borderWidth:0},series:b})},sendAjax:function(){a.ajax({url:"/rpt_mall_timerange_visit_index_d",data:{day1:a("#j_searchTime1").val().split("-").join(""),day2:a("#j_searchTime2").val().split("-").join("")},dataType:"json"}).done(function(a){if(a&&200==a.code){for(var b=a.data1,c=a.data2,f=[],g=[],h=0;h<b.length;h++)f.push(parseInt(b[h].visitors)||0),g.push(parseInt(c[h].visitors)||0);var i=[];for(var j in d.days)i.push(d.days[j]);e.setChart([{name:b[0].event_day,data:f},{name:c[0].event_day,data:g}])}}).fail(function(){})},bind:function(){a("#j_contrast").on("click",function(){e.sendAjax()})}},f=function(){e.setCal(),e.bind(),a("#j_contrast").trigger("click")};f(),$$m.finish("ok")});