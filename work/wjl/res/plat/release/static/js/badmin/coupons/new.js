seajs.use("placeholders"),seajs.use(["select"],function(a){new a({trigger:"#sltStartHour"}).render(),new a({trigger:"#sltStartMinute"}).render(),new a({trigger:"#sltStartSecond"}).render(),new a({trigger:"#sltEndHour"}).render(),new a({trigger:"#sltEndMinute"}).render(),new a({trigger:"#sltEndSecond"}).render()}),seajs.use(["$"],function(a){function b(b,c){0==b?a(c).val("").attr("readonly","true"):a(c).removeAttr("readonly")}a('input[name="quantity"]').click(function(){b(a(this).index('input[name="quantity"]'),'input[name="quantityValue"]')}),a('input[name="limitQuantity"]').click(function(){b(a(this).index('input[name="limitQuantity"]'),'input[name="limitQuantityValue"]')}),b(a('input[name="quantity"]:checked').index('input[name="quantity"]'),'input[name="quantityValue"]'),b(a('input[name="limitQuantity"]:checked').index('input[name="limitQuantity"]'),'input[name="limitQuantityValue"]')}),seajs.use(["$","uploadify","_"],function(a,b,c){a("#uploader-3").uploadify({height:152,width:153,preventCaching:!1,buttonImage:$$c.staticUrl+"/static/images/upload.png",swf:$$c.staticUrl+"/static/images/uploadify.swf",uploader:"/upload",fileObjName:"image",onUploadSuccess:function(b,d){var e="";d=a.parseJSON(d),c.each(d.url,function(a){e+="<li><img class='loaded-img' src="+a+" /></li>"}),a("#uploadImg .btn-upload").before(e)}})}),seajs.use("calendar_css"),seajs.use("calendar",function(a){var b=new a({trigger:"#startDate"}),c=new a({trigger:"#endDate"});b.on("selectDate",function(a){c.range([a,null])}),c.on("selectDate",function(a){b.range([null,a])})}),seajs.use(["validator","$","util"],function(a,b,c){b(function(){function d(){var a=function(){var a=[];return b.each(arguments,function(c,d){a.push(b(d).val())}),a.join(":")},d=b("#"+e),f=d.attr("data-type"),g=b("#startDate").val()+" "+a("#sltStartHour","#sltStartMinute","#sltStartSecond"),h=b("#endDate").val()+" "+a("#sltEndHour","#sltEndMinute","#sltEndSecond");try{c.formSend("#"+e,{extraData:{bcType:f,startDate:g,endDate:h},ajaxSuccess:function(a){a=a||{},alert(a.msg||"提交成功")},error:function(){alert("操作超时")},submitButton:"#btnSave"})}catch(i){alert(i.message||"系统出错了")}}var e="frmCoupon";b("#activityForm").attr("id",e);var f=new a({element:"#"+e,onFormValidated:function(a){1!=a&&d()},autoSubmit:!1,failSilently:!0});f.addItem({element:"#input-title",required:!0,errormessageRequired:"请输入标题。"}).addItem({element:"#startDate",required:!0,errormessageRequired:"请输入结束时间。"}).addItem({element:"#endDate",required:!0,errormessageRequired:"请输入结束时间。"}).addItem({element:"#description",required:!0,errormessageRequired:"请输入描述。"}).addItem({element:"[name=price]",required:!0,errormessageRequired:"请至少选择一项。"}),b("#btnSave,#btnConfirm").click(function(){var a=1;"btnSave"==b.trim(b(this).attr("id"))&&(a=2),b(this).parents("form").first().attr("data-type",a).submit()})})});